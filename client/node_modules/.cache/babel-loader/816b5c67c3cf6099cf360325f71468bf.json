{"ast":null,"code":"import _asyncToGenerator from\"/Users/saatvikshrivastava/Downloads/chat/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/saatvikshrivastava/Downloads/chat/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/saatvikshrivastava/Downloads/chat/client/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState}from\"react\";import{Col,Container,Form,Row,Button}from\"react-bootstrap\";import{useSignupUserMutation}from\"../services/appApi\";import{Link,useNavigate}from\"react-router-dom\";import\"./Signup.css\";import botImg from\"../assets/bot.jpeg\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Signup(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),name=_useState6[0],setName=_useState6[1];var _useSignupUserMutatio=useSignupUserMutation(),_useSignupUserMutatio2=_slicedToArray(_useSignupUserMutatio,2),signupUser=_useSignupUserMutatio2[0],_useSignupUserMutatio3=_useSignupUserMutatio2[1],isLoading=_useSignupUserMutatio3.isLoading,error=_useSignupUserMutatio3.error;var navigate=useNavigate();//image upload states\nvar _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),image=_useState8[0],setImage=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),upladingImg=_useState10[0],setUploadingImg=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),imagePreview=_useState12[0],setImagePreview=_useState12[1];function validateImg(e){var file=e.target.files[0];if(file.size>=1048576){return alert(\"Max file size is 1mb\");}else{setImage(file);setImagePreview(URL.createObjectURL(file));}}function uploadImage(){return _uploadImage.apply(this,arguments);}function _uploadImage(){_uploadImage=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data,res,urlData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:data=new FormData();data.append(\"file\",image);data.append(\"upload_preset\",\"ubaqqddo\");_context.prev=3;setUploadingImg(true);_context.next=7;return fetch(\"https://api.cloudinary.com/v1_1/dutz9pnhl/image/upload\",{method:\"post\",body:data});case 7:res=_context.sent;_context.next=10;return res.json();case 10:urlData=_context.sent;setUploadingImg(false);return _context.abrupt(\"return\",urlData.url);case 15:_context.prev=15;_context.t0=_context[\"catch\"](3);setUploadingImg(false);console.log(_context.t0);case 19:case\"end\":return _context.stop();}}},_callee,null,[[3,15]]);}));return _uploadImage.apply(this,arguments);}function handleSignup(_x){return _handleSignup.apply(this,arguments);}function _handleSignup(){_handleSignup=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var url;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();if(image){_context2.next=3;break;}return _context2.abrupt(\"return\",alert(\"Please upload your profile picture\"));case 3:_context2.next=5;return uploadImage(image);case 5:url=_context2.sent;console.log(url);// signup the user\nsignupUser({name:name,email:email,password:password,picture:url}).then(function(_ref){var data=_ref.data;if(data){console.log(data);navigate(\"/chat\");}});case 8:case\"end\":return _context2.stop();}}},_callee2);}));return _handleSignup.apply(this,arguments);}return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:7,className:\"d-flex align-items-center justify-content-center flex-direction-column\",children:/*#__PURE__*/_jsxs(Form,{style:{width:\"80%\",maxWidth:500},onSubmit:handleSignup,children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-center\",children:\"Create account\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"signup-profile-pic__container\",children:[/*#__PURE__*/_jsx(\"img\",{src:imagePreview||botImg,className:\"signup-profile-pic\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"image-upload\",className:\"image-upload-label\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus-circle add-picture-icon\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"image-upload\",hidden:true,accept:\"image/png, image/jpeg\",onChange:validateImg})]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"alert alert-danger\",children:error.data}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formBasicName\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Your name\",onChange:function onChange(e){return setName(e.target.value);},value:name})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formBasicEmail\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Email address\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"email\",placeholder:\"Enter email\",onChange:function onChange(e){return setEmail(e.target.value);},value:email}),/*#__PURE__*/_jsx(Form.Text,{className:\"text-muted\",children:\"We'll never share your email with anyone else.\"})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formBasicPassword\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",placeholder:\"Password\",onChange:function onChange(e){return setPassword(e.target.value);},value:password})]}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",children:upladingImg||isLoading?\"Signing you up...\":\"Signup\"}),/*#__PURE__*/_jsx(\"div\",{className:\"py-4\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-center\",children:[\"Already have an account ? \",/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"Login\"})]})})]})}),/*#__PURE__*/_jsx(Col,{md:5,className:\"signup__bg\"})]})});}export default Signup;","map":{"version":3,"sources":["/Users/saatvikshrivastava/Downloads/chat/client/src/pages/Signup.js"],"names":["React","useState","Col","Container","Form","Row","Button","useSignupUserMutation","Link","useNavigate","botImg","Signup","email","setEmail","password","setPassword","name","setName","signupUser","isLoading","error","navigate","image","setImage","upladingImg","setUploadingImg","imagePreview","setImagePreview","validateImg","e","file","target","files","size","alert","URL","createObjectURL","uploadImage","data","FormData","append","fetch","method","body","res","json","urlData","url","console","log","handleSignup","preventDefault","picture","then","width","maxWidth","value"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { Col, Container, Form, Row, Button } from \"react-bootstrap\";\nimport { useSignupUserMutation } from \"../services/appApi\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport \"./Signup.css\";\nimport botImg from \"../assets/bot.jpeg\";\n\nfunction Signup() {\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [name, setName] = useState(\"\");\n    const [signupUser, { isLoading, error }] = useSignupUserMutation();\n    const navigate = useNavigate();\n    //image upload states\n    const [image, setImage] = useState(null);\n    const [upladingImg, setUploadingImg] = useState(false);\n    const [imagePreview, setImagePreview] = useState(null);\n\n    function validateImg(e) {\n        const file = e.target.files[0];\n        if (file.size >= 1048576) {\n            return alert(\"Max file size is 1mb\");\n        } else {\n            setImage(file);\n            setImagePreview(URL.createObjectURL(file));\n        }\n    }\n\n    async function uploadImage() {\n        const data = new FormData();\n        data.append(\"file\", image);\n        data.append(\"upload_preset\", \"ubaqqddo\");\n        try {\n            setUploadingImg(true);\n            let res = await fetch(\"https://api.cloudinary.com/v1_1/dutz9pnhl/image/upload\", {\n                method: \"post\",\n                body: data,\n            });\n            const urlData = await res.json();\n            setUploadingImg(false);\n            return urlData.url;\n        } catch (error) {\n            setUploadingImg(false);\n            console.log(error);\n        }\n    }\n\n    async function handleSignup(e) {\n        e.preventDefault();\n        if (!image) return alert(\"Please upload your profile picture\");\n        const url = await uploadImage(image);\n        console.log(url);\n        // signup the user\n        signupUser({ name, email, password, picture: url }).then(({ data }) => {\n            if (data) {\n                console.log(data);\n                navigate(\"/chat\");\n            }\n        });\n    }\n\n    return (\n        <Container>\n            <Row>\n                <Col md={7} className=\"d-flex align-items-center justify-content-center flex-direction-column\">\n                    <Form style={{ width: \"80%\", maxWidth: 500 }} onSubmit={handleSignup}>\n                        <h1 className=\"text-center\">Create account</h1>\n                        <div className=\"signup-profile-pic__container\">\n                            <img src={imagePreview || botImg} className=\"signup-profile-pic\" />\n                            <label htmlFor=\"image-upload\" className=\"image-upload-label\">\n                                <i className=\"fas fa-plus-circle add-picture-icon\"></i>\n                            </label>\n                            <input type=\"file\" id=\"image-upload\" hidden accept=\"image/png, image/jpeg\" onChange={validateImg} />\n                        </div>\n                        {error && <p className=\"alert alert-danger\">{error.data}</p>}\n                        <Form.Group className=\"mb-3\" controlId=\"formBasicName\">\n                            <Form.Label>Name</Form.Label>\n                            <Form.Control type=\"text\" placeholder=\"Your name\" onChange={(e) => setName(e.target.value)} value={name} />\n                        </Form.Group>\n                        <Form.Group className=\"mb-3\" controlId=\"formBasicEmail\">\n                            <Form.Label>Email address</Form.Label>\n                            <Form.Control type=\"email\" placeholder=\"Enter email\" onChange={(e) => setEmail(e.target.value)} value={email} />\n                            <Form.Text className=\"text-muted\">We'll never share your email with anyone else.</Form.Text>\n                        </Form.Group>\n\n                        <Form.Group className=\"mb-3\" controlId=\"formBasicPassword\">\n                            <Form.Label>Password</Form.Label>\n                            <Form.Control type=\"password\" placeholder=\"Password\" onChange={(e) => setPassword(e.target.value)} value={password} />\n                        </Form.Group>\n                        <Button variant=\"primary\" type=\"submit\">\n                            {upladingImg || isLoading ? \"Signing you up...\" : \"Signup\"}\n                        </Button>\n                        <div className=\"py-4\">\n                            <p className=\"text-center\">\n                                Already have an account ? <Link to=\"/login\">Login</Link>\n                            </p>\n                        </div>\n                    </Form>\n                </Col>\n                <Col md={5} className=\"signup__bg\"></Col>\n            </Row>\n        </Container>\n    );\n}\n\nexport default Signup;\n"]},"metadata":{},"sourceType":"module"}